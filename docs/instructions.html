<!DOCTYPE html PUBLIC ""
    "">
<html><head><meta charset="UTF-8" /><title>Instructions</title><link rel="stylesheet" type="text/css" href="css/default.css" /><link rel="stylesheet" type="text/css" href="css/highlight.css" /><script type="text/javascript" src="js/highlight.min.js"></script><script type="text/javascript" src="js/jquery.min.js"></script><script type="text/javascript" src="js/page_effects.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div id="header"><h2>Generated by <a href="https://github.com/weavejester/codox">Codox</a></h2><h1><a href="index.html"><span class="project-title"><span class="project-name">Plushi</span> <span class="project-version">0.1.0</span></span></a></h1></div><div class="sidebar primary"><h3 class="no-link"><span class="inner">Project</span></h3><ul class="index-link"><li class="depth-1 "><a href="index.html"><div class="inner">Index</div></a></li></ul><h3 class="no-link"><span class="inner">Topics</span></h3><ul><li class="depth-1 "><a href="contributing.html"><div class="inner"><span>Contributing</span></div></a></li><li class="depth-1 "><a href="generating_programs.html"><div class="inner"><span>Generating Programs</span></div></a></li><li class="depth-1 "><a href="getting_started.html"><div class="inner"><span>Getting Started</span></div></a></li><li class="depth-1  current"><a href="instructions.html"><div class="inner"><span>Instructions</span></div></a></li><li class="depth-1 "><a href="running_programs.html"><div class="inner"><span>Running Programs</span></div></a></li></ul><h3 class="no-link"><span class="inner">Namespaces</span></h3><ul><li class="depth-1"><div class="no-link"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>plushi</span></div></div></li><li class="depth-2 branch"><a href="plushi.atoms.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>atoms</span></div></a></li><li class="depth-2 branch"><a href="plushi.core.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>core</span></div></a></li><li class="depth-2"><a href="plushi.instruction.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>instruction</span></div></a></li><li class="depth-3"><a href="plushi.instruction.io.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>io</span></div></a></li><li class="depth-2 branch"><a href="plushi.interpreter.html"><div class="inner"><span class="tree" style="top: -52px;"><span class="top" style="height: 61px;"></span><span class="bottom"></span></span><span>interpreter</span></div></a></li><li class="depth-2 branch"><a href="plushi.state.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>state</span></div></a></li><li class="depth-2"><a href="plushi.utils.html"><div class="inner"><span class="tree"><span class="top"></span><span class="bottom"></span></span><span>utils</span></div></a></li></ul></div><div class="document" id="content"><div class="doc"><div class="markdown"><h1><a href="#instructions" name="instructions"></a>Instructions</h1>
<h2><a href="#built-in-instructions" name="built-in-instructions"></a>Built-in Instructions</h2>
<p>Plushi aims to provide an expressive, general purpose set of instructions that mirror the built-in capabilities of most modern modern languages. The built in instruction set covers the typical opperations that can be performed on the following data types.</p>
<ul>
  <li>Integers</li>
  <li>Float</li>
  <li>Booleans</li>
  <li>Strings</li>
  <li>Characters</li>
  <li>Vectors (Coming soon)</li>
</ul>
<p>Plushi also uses instructions to implement control structures such as if-else and loops. These instructions are implemented by manipulating the exectution (<code>exec</code>) stack which holds the instructions and literals which have yet to be executed.</p>
<p>A webpage detailing all supported instructions can be found <a href="plushi_instruction_set.html">here</a>.</p>
<h2><a href="#defining-new-instructions" name="defining-new-instructions"></a>Defining New Instructions</h2>
<p>It is not uncommon to require specialized instrutions for particular applications of the Push language.</p>
<p>Plushi does not currently support any form of runtime user defined instructions (UDI), although it is trivial to add your own instructions in the Plushi source code and build your own version of the interpreter. If you feel your instructions are likely to be of any interest to other users, please consider <a href="">contributing them</a> to the plushi project on GitHub.</p>
<p>The define your own instruction, simply call <code>plushi.instruction/register</code> with the necessary components. The componensts are listsed and defined below.</p>
<ul>
  <li><strong>Name:</strong> A unique string with respect to the other instructions in the instruction set.</li>
  <li><strong>Function:</strong> Clojure function which implements the behavior of your instruction.</li>
  <li><strong>Input-types:</strong> A vector of stack types to be used when retreiving the arguments to the function.</li>
  <li><strong>Output-types:</strong> A vector of stack types to be used when routing the output of the function back onto the stacks.</li>
  <li><strong>Code-blocks:</strong> An integer denoting the number of code blocks that follow the instruction. This is commonly used when implementing control structures. More information about this is given in a later section.</li>
  <li><strong>Docstring (optional):</strong> A string explaining what the instruction does. Should be included for instructions that are going to be contributed to the official Plushi codebase.</li>
</ul>
<p>Below are some examples of registering new instrutions.</p>
<pre><code class="clojure">(require '[plushi.instruction :as i])

(i/register "float_sin"
            #(Math/sin %)
            [:float] [:float] 0
            "Pushes the sin of the top float.")

(i/register "string_head"
            #(subs %1 0 %2)
            [:string :integer] [:string] 0
            "Pushes a string of the first N characters from the top string. N is the top integer.")

(i/register "exec_if"
            (fn [b then else]
              (if b then else))
            [:boolean :exec :exec] [:exec] 2
            "If the top boolean is true, execute the top element of the exec
            stack and skip the second. Otherwise, skip the top element of the
            exec stack and execute the second.")
</code></pre>
<p>After creating a namespace with your instructions, add the namespace to the list of namespaces <code>use</code>-ed at the bottom of <code>instruction.clj</code> and rebuild the Plushi standalone jar with <code>lein uberjar</code>.</p>
<h2><a href="#code-blocks" name="code-blocks"></a>Code Blocks</h2>
<p>As mentioned above, some instructions are followed by some number of “code-blocks”. The code blocks make up the body of loops, if-else, and other control structures. To see how this works, lets consider the following Plushi program.</p>
<pre><code class="json">["plushi:input_0", "plushi:exec_if", 5, "plushi:close", 3, 1, "plushi:close"]
</code></pre>
<p>The <code>exec_if</code> instruction implements the standard <code>if-else</code> constrol structure where there is a body of code to be run under the <code>if</code> clause and a seperate body of the code to be run under the <code>else</code> clause. In the case of <code>exec_if</code>, a different body of code should be run depending on if the top boolean is true or false.</p>
<p>The definition of <code>exec_if</code> specifies that the instruction opens 2 “code-blocks”, one for the body of the <code>if</code> and one for the body of the <code>else</code>. However, since Plushi programs are always linear, it is still unlear which instructions in the program are part of each of these two code blocks.</p>
<p>To denote when a code block is closed, a dummy “close” instruction is used. These instructions can be seen in the example program above. Any instruction or literal that appears between an instruction which opens a code block and a close instruction is considered to be in the code block.</p>
<p>If a close instruction appears in a program when no code blocks are open, it is ignored. If an instruction opens a code block and there are no close instructions to denote the end of the code block, the remainder of the program is considered to be in code block.</p></div></div></div></body></html>